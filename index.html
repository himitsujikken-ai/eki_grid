<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ç¥ç¾…ä¸‡è±¡ã‚°ãƒªãƒƒãƒ‰ | é‹å‘½ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰</title>
<meta name="description" content="è‡ªåˆ†ã¨ã„ã†å®‡å®™ã‚’èª­ã¿è§£ãã€ç¾ä»£ã®ç¥ç¾…é‡ç›¤ã€‚">
<meta property="og:title" content="ç¥ç¾…ä¸‡è±¡ã‚°ãƒªãƒƒãƒ‰">
<meta property="og:description" content="é‹å‘½ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ã€‚">
<meta property="og:image" content="https://uranai1.vercel.app/ogp.png"> <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<style>
    /* --- ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ãƒ¼ãƒï¼šThe Matrix Grid --- */
    :root {
        --matrix-green: #0F0;
        --matrix-dark: #003300;
        --neon-cyan: #00f2ff;
        --ginza-gold: #c5a059;
        --text-color: #e0e0e0;
    }

    body {
        font-family: "Hiragino Mincho ProN", "Yu Mincho", serif;
        background: #000; margin: 0; padding: 0;
        color: var(--text-color);
        display: flex; flex-direction: column; align-items: center;
        min-height: 100vh; overflow-x: hidden;
        -webkit-text-size-adjust: 100%;
    }

    #matrix-canvas {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1; opacity: 0.8;
    }

    header {
        width: 100%; padding: 30px 20px 10px; text-align: center;
        background: linear-gradient(to bottom, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.8) 100%);
        z-index: 10;
    }

    h1 {
        font-size: 26px; color: var(--matrix-green);
        text-shadow: 0 0 10px var(--matrix-green);
        margin: 0; letter-spacing: 0.1em; font-family: monospace;
    }
    .subtitle { font-size: 10px; color: #fff; letter-spacing: 0.3em; margin-top: 5px; }

    /* è§£èª¬ã‚¨ãƒªã‚¢ */
    .intro-explanation {
        width: 90%; max-width: 600px; margin: 20px auto;
        border: 1px solid var(--matrix-dark);
        background: rgba(0, 20, 0, 0.7);
        border-left: 3px solid var(--matrix-green);
        padding: 15px; box-sizing: border-box;
        text-align: left; font-size: 13px; line-height: 1.8;
        color: #cfcfcf;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.05);
    }
    .intro-title {
        color: var(--matrix-green); font-weight: bold; font-size: 16px;
        margin-bottom: 5px; border-bottom: 1px dashed var(--matrix-dark); padding-bottom: 5px;
    }
    .toggle-btn {
        display: block; width: 100%; text-align: center;
        background: rgba(0, 50, 0, 0.5); color: var(--matrix-green);
        border: 1px solid var(--matrix-dark);
        padding: 8px; margin-top: 10px; cursor: pointer;
        font-size: 12px; font-family: monospace; transition: 0.3s;
    }
    #hidden-desc { display: none; margin-top: 15px; border-top: 1px dashed var(--matrix-dark); padding-top: 15px; }
    
    /* 3x3 Grid */
    .magic-grid {
        display: grid; grid-template-columns: repeat(3, 1fr);
        gap: 2px; width: 120px; margin: 10px auto;
        background: var(--matrix-green); border: 2px solid var(--matrix-green);
    }
    .grid-cell {
        background: #000; color: var(--matrix-green);
        height: 40px; display: flex; align-items: center; justify-content: center;
        font-weight: bold; font-family: monospace; font-size: 16px;
    }

    /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
    .container {
        width: 90%; max-width: 450px; padding-bottom: 20px;
        display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
        z-index: 10; margin-top: 10px;
    }
    .menu-btn {
        position: relative; width: 100%; padding: 25px 10px;
        background: rgba(0, 30, 0, 0.6); color: var(--matrix-green);
        border: 1px solid rgba(0, 255, 0, 0.3); border-radius: 2px;
        font-family: monospace; font-size: 14px; letter-spacing: 0.05em;
        cursor: pointer; transition: 0.2s;
        box-shadow: 0 0 5px rgba(0, 255, 0, 0.1);
    }
    .menu-btn:active { transform: scale(0.96); background: rgba(0, 255, 0, 0.1); }
    .menu-btn span { display: block; font-size: 10px; opacity: 0.7; margin-top: 5px; color: #fff; }
    .menu-btn.full-width { grid-column: 1 / 3; border-color: var(--ginza-gold); color: var(--ginza-gold); }
    
    /* å±¥æ­´ãƒœã‚¿ãƒ³ */
    .btn-history {
        grid-column: 1 / 3;
        background: rgba(0, 20, 50, 0.6); color: #aaa;
        border: 1px dashed #555; font-size: 12px; padding: 15px;
    }

    /* ãƒ•ãƒƒã‚¿ãƒ¼ï¼šã‚¢ãƒ¼ã‚«ã‚¤ãƒ– */
    .system-archive {
        width: 90%; max-width: 600px; margin: 20px auto 80px;
        border-top: 2px solid var(--matrix-dark);
        padding-top: 20px; z-index: 10; text-align: center;
    }
    .archive-header {
        display: inline-block; color: var(--matrix-dark); cursor: pointer;
        font-family: monospace; font-size: 12px; letter-spacing: 2px;
        transition: 0.3s; padding: 10px 20px; border: 1px solid transparent;
        background: rgba(0,20,0,0.5);
    }
    #archive-content {
        display: none; background: rgba(0, 10, 0, 0.95);
        border: 1px solid var(--matrix-green);
        padding: 25px; margin-top: 15px;
        color: #bbb; font-size: 13px; line-height: 1.9; text-align: left;
    }
    #archive-content h3 { color: var(--matrix-green); font-size: 16px; border-bottom: 1px solid var(--matrix-green); margin-top: 40px; margin-bottom: 15px; }
    #archive-content h4 { color: var(--ginza-gold); font-size: 14px; margin-top: 25px; border-left: 3px solid var(--ginza-gold); padding-left: 10px; }

    /* --- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ --- */
    .overlay-base {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-color: rgba(0, 0, 0, 0.95);
        flex-direction: column; justify-content: center; align-items: center;
        backdrop-filter: blur(5px); opacity: 0; transition: opacity 0.5s ease;
        padding: 20px; box-sizing: border-box;
        font-family: monospace; color: var(--matrix-green); z-index: 2000;
    }
    .overlay-base.show { opacity: 1; }

    /* å±¥æ­´ãƒ¢ãƒ¼ãƒ€ãƒ« */
    #history-modal { z-index: 2500; justify-content: flex-start; padding-top: 80px; }
    .history-list {
        width: 100%; max-width: 500px; max-height: 70vh; overflow-y: auto;
        border: 1px solid var(--matrix-dark); background: rgba(0,20,0,0.8);
        padding: 10px;
    }
    .history-item {
        border-bottom: 1px dashed #333; padding: 10px; text-align: left; font-size: 12px;
    }
    .history-date { color: #666; font-size: 10px; margin-bottom: 3px; }
    .history-theme { color: var(--ginza-gold); font-weight: bold; }
    .history-result { color: var(--matrix-green); margin-top: 5px; font-size: 14px; }

    /* ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ */
    #instruction-overlay { z-index: 1500; }
    .instruction-box {
        width: 100%; max-width: 400px; padding: 30px 25px;
        border-radius: 4px; text-align: center;
        border: 2px solid var(--matrix-green); background: rgba(0, 20, 0, 0.8);
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
    }
    .instruction-icon { font-size: 50px; margin-bottom: 20px; animation: float 2s infinite ease-in-out; }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

    /* çµæœãƒ¢ãƒ¼ãƒ€ãƒ« */
    #result-area { z-index: 1000; background-color: rgba(0, 0, 0, 0.9); }
    .result-box {
        width: 100%; max-width: 400px; padding: 40px 20px;
        border-radius: 4px; text-align: center; position: relative;
        box-shadow: 0 0 30px rgba(0, 255, 0, 0.2);
        max-height: 70vh; overflow-y: auto;
        border: 1px solid var(--matrix-green); background: #000;
        transform: scale(0.9); transition: transform 0.4s;
    }
    #result-area.show .result-box { transform: scale(1); }

    /* ãƒ¢ãƒ¼ãƒ‰åˆ¥ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .mode-god, .mode-override { border: 2px solid #FFD700; box-shadow: 0 0 60px rgba(255, 215, 0, 0.3); }
    .mode-iching { border: 1px solid var(--matrix-green); }
    
    .symbol { display: block; margin-bottom: 10px; line-height: 1; font-size: 80px; }
    .name { font-size: 28px; font-weight: bold; margin: 10px 0; letter-spacing: 0.1em; }
    .desc-box {
        text-align: left; font-size: 15px; line-height: 1.8;
        padding: 20px; background: rgba(0, 50, 0, 0.2);
        border: 1px solid rgba(0, 255, 0, 0.2);
        border-radius: 4px; margin-top: 10px;
    }
    .override-original {
        opacity: 0.6; text-decoration: line-through double red; font-size: 12px;
        background: rgba(50,0,0,0.3); border: 1px dashed red; padding: 10px; margin-bottom: 15px; position: relative;
    }
    .override-original::after {
        content: "ã€DELETED DATAã€‘"; position: absolute; top: -10px; right: 5px;
        background: red; color: black; font-size: 10px; padding: 2px 5px; font-weight: bold;
    }
    
    /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
    .action-area { width: 100%; max-width: 400px; margin-top: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1001; }
    .btn-row { display: flex; gap: 10px; }
    .btn-row .action-btn { flex: 1; }
    .action-btn {
        padding: 15px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer;
        display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; font-size: 14px; font-family: monospace;
    }
    .btn-share { background: var(--matrix-green); color: #000; box-shadow: 0 0 10px var(--matrix-green); }
    .btn-cal { background: #003366; color: #fff; border: 1px solid #0055aa; box-shadow: 0 0 10px #003366; }
    .btn-x { background: #000; color: #fff; border: 1px solid #fff; }
    .btn-close { background: transparent; color: #888; border: 1px solid #333; }
    .btn-to-love { margin-top:20px; background: transparent; color: var(--matrix-green); border: 1px dotted var(--matrix-green); font-size:12px; cursor:pointer; opacity: 0.7; }

    /* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»å…‰ç·š */
    #horizon-scan {
        position: fixed; top: 50%; left: 0; width: 100%; height: 2px;
        background: #fff; box-shadow: 0 0 20px #fff, 0 0 40px var(--neon-cyan);
        z-index: 2150; transform: scaleX(0); opacity: 0; pointer-events: none;
    }
    .animate-scan { animation: horizonScan 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    @keyframes horizonScan { 0% { transform: scaleX(0); opacity: 1; } 50% { transform: scaleX(1); opacity: 1; } 100% { transform: scaleX(1); opacity: 0; } }
    
    .upload-text { font-size: 16px; letter-spacing: 2px; color: var(--matrix-green); text-shadow: 0 0 10px var(--matrix-green); }
    .fade-text { animation: textFade 2.8s linear forwards; }
    @keyframes textFade { 0% { opacity: 0; transform: translateY(10px); } 20% { opacity: 1; transform: translateY(0); } 80% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-10px); } }

</style>
</head>
<body>

<canvas id="matrix-canvas"></canvas>

<header>
    <h1>ç¥ç¾…ä¸‡è±¡ã‚°ãƒªãƒƒãƒ‰<div class="subtitle">SYSTEM: SHINRA-BANSHO</div></h1>
    <div class="intro-explanation">
        <div class="intro-title">æ£®ç¾…ä¸‡è±¡GRID</div>
        <p>ä¸–ç•Œã¯ã€ç¸¦ã¨æ¨ªã®ç³¸ã«ã‚ˆã£ã¦ç·¨ã¾ã‚Œã¦ã„ã¾ã™ã€‚ç¸¦ã¯ã€Œæ„å›³ã¨æµã‚Œã€ã€‚æ¨ªã¯ã€Œé–¢ä¿‚ã¨å¾ªç’°ã€ã€‚ãã—ã¦ãã®ä¸­å¿ƒã«ã¯ã€å¿…ãšâ€œã‚ãªãŸâ€ãŒã„ã¾ã™ã€‚</p>
        <button id="toggle-desc-btn" class="toggle-btn" onclick="toggleDescription()">â–¼ ã‚ˆã‚Šè©³ç´°ã®è§£èª¬ã‚’ç¢ºèªã™ã‚‹...</button>
        <div id="hidden-desc">
            <h4>â– æ•°éœŠå¤©ç›¤</h4>
            <div class="magic-grid">
                <div class="grid-cell">4</div><div class="grid-cell">9</div><div class="grid-cell">2</div>
                <div class="grid-cell">3</div><div class="grid-cell">5</div><div class="grid-cell">7</div>
                <div class="grid-cell">8</div><div class="grid-cell">1</div><div class="grid-cell">6</div>
            </div>
            <p>å³è¡¨ã®å·¦ä¸Šãƒ–ãƒ­ãƒƒã‚¯ã®9æ•°ã‚’ä¸¸ã‚ã‚‹ã¨ã€ã™ã¹ã¦ã®å’ŒãŒèª¿å’Œã™ã‚‹é…ç½®æ•°ã«ãªã‚Šã¾ã™ã€‚</p>
            <h4>â– å ã„ã§ã¯ãªãã€â€œä½ç½®èª¿æ•´â€</h4>
            <p>ã“ã“ã§æ‰±ã†ã®ã¯ã€æœªæ¥ã‚’å½“ã¦ã‚‹ãŸã‚ã®å ã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æœ¬æ¥ã®å è¡“ãŒæŒã£ã¦ã„ãŸã€ã€Œè‡ªåˆ†ã¨ä¸–ç•Œã®é–¢ä¿‚æ€§ã‚’æ•´ãˆã‚‹ãŸã‚ã®ç¾…é‡ç›¤ã€ã¨ã„ã†å½¹å‰²ã‚’å–ã‚Šæˆ»ã—ãŸã‚‚ã®ã§ã™ã€‚</p>
        </div>
    </div>
</header>

<div class="container">
    <button class="menu-btn" onclick="initiateDivination('ä»Šã®ç¾åœ¨åœ°', 'Status Check')">ç¾åœ¨åœ°ã®ç‰¹å®š<span>> Check Status</span></button>
    <button class="menu-btn" onclick="initiateDivination('æœªæ¥ã®åˆ†å²ç‚¹', 'Future Branch')">æœªæ¥ã®åˆ†å²ç‚¹<span>> Scan Future</span></button>
    <button class="menu-btn" onclick="initiateDivination('äººé–“é–¢ä¿‚ã®ãƒã‚°', 'Relation Debug')">é–¢ä¿‚æ€§ã®ãƒã‚°<span>> Debug Relations</span></button>
    <button class="menu-btn" onclick="initiateDivination('é‡‘è„ˆã®æ‰€åœ¨', 'Gold Vein')">é‡‘è„ˆã®æ‰€åœ¨<span>> Scan Economy</span></button>
    <button class="menu-btn full-width" onclick="initiateDivination('éš ã•ã‚ŒãŸçœŸå®Ÿ', 'Deep Dive')">æ·±å±¤ãƒ€ã‚¤ãƒ–ï¼ˆéš ã•ã‚ŒãŸçœŸå®Ÿï¼‰<span>> Execute Deep Dive</span></button>
    
    <button class="menu-btn btn-history" onclick="showHistory()">ğŸ“œ éå»ã®è¦³æ¸¬ãƒ­ã‚°ï¼ˆå±¥æ­´ï¼‰ã‚’è¦‹ã‚‹</button>
    
    <button class="btn-to-love" onclick="location.href='love.html'">> æ‹æ„›ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£æã¸ç§»å‹•</button>
</div>

<footer class="system-archive">
    <div class="archive-header" onclick="toggleArchive()">[ SYSTEM ARCHIVES : DETAILED_LOGS ]<br>â–¼ ACCESS DATA</div>
    <div id="archive-content">
        <h3>1. ã™ã¹ã¦ã¯â€œè¦‹ãˆãªã„æ§‹é€ â€ã‹ã‚‰å§‹ã¾ã£ãŸ</h3>
        <p>ã€Œä¸–ç•Œã¯ç¸¦ã¨æ¨ªã®ç³¸ã§ç·¨ã¾ã‚Œã€ç”Ÿå‘½ã‚‚ç¤¾ä¼šã‚‚è‡ªç„¶ã‚‚åŒã˜â€œå¾ªç’°ã®è¨­è¨ˆå›³â€ã‚’æŒã¤ã€...</p>
        <p style="text-align:center;">æ£®ç¾…ä¸‡è±¡GRIDã¯ã€ã‚ãªãŸã®å“²ç†ã¨æ›¸ç±ã®æ•°ç†ãŒçµæ™¶åŒ–ã—ãŸâ€œç¾ä»£ã®ç¥ç¾…é‡ç›¤"ã§ã‚ã‚‹ã€‚</p>
    </div>
</footer>

<div id="history-modal" class="overlay-base">
    <h2 style="color:var(--matrix-green); border-bottom:1px solid var(--matrix-green); width:100%; max-width:500px; padding-bottom:10px;">> ACCESS LOGS</h2>
    <div id="history-list" class="history-list">
        </div>
    <button class="action-btn btn-close" style="margin-top:20px;" onclick="closeHistory()">Close Logs</button>
</div>

<div id="horizon-scan"></div>

<div id="instruction-overlay" class="overlay-base">
    <div class="instruction-box">
        <div style="border-bottom:1px solid var(--matrix-green); margin-bottom:20px; padding-bottom:5px;">
            <div id="instruction-theme-jp" style="font-size:20px; font-weight:bold; color:var(--matrix-green);"></div>
        </div>
        <div class="instruction-icon">ğŸ§ </div>
        <p class="instruction-text">ç¥çµŒã‚’ç ”ãæ¾„ã¾ã›ã€‚<br>çŸ¥ã‚ŠãŸã„ã“ã¨ã‚’<br><span style="color:var(--matrix-green); font-size:24px; font-weight:bold;">ä¸‰å›</span>ã€å¿ƒã®ä¸­ã§å”±ãˆã‚ˆã€‚</p>
        <button class="action-btn btn-share" onclick="startUploadSequence()">å”±ãˆãŸã€‚æ¥ç¶šã‚’é–‹å§‹ã™ã‚‹ã€‚</button>
        <button class="action-btn btn-close" style="margin-top:10px; border:1px solid var(--matrix-green); color:var(--matrix-green);" onclick="closeInstruction()">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
    </div>
</div>

<div id="upload-overlay" class="overlay-base">
    <div class="upload-text-container" style="height:60px; display:flex; align-items:center;">
        <div id="upload-text-dynamic" class="upload-text">INITIALIZING...</div>
    </div>
</div>

<div id="loading-overlay" class="overlay-base">
    <div class="upload-text">DOWNLOADING RESULT...</div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
</div>

<div id="result-area" class="overlay-base">
    <div id="capture-target" class="result-box">
        <div id="result-content"></div>
    </div>
    <div class="action-area" id="action-buttons" style="display:none;">
        <div class="btn-row">
            <button onclick="shareImage()" class="action-btn btn-share">ğŸ’¾ ç”»åƒä¿å­˜</button>
            <a id="btn-cal" class="action-btn btn-cal" target="_blank">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>
        </div>
        <div class="btn-row">
            <a id="btn-x" class="action-btn btn-x" target="_blank">ğ• Post</a>
            <a id="btn-line" class="action-btn" style="background:#06c755; color:#fff;" target="_blank">LINE Send</a>
        </div>
        <button onclick="closeResult()" class="action-btn btn-close">Close Terminal</button>
    </div>
</div>

<script>
    /* Matrix Rain */
    const canvas = document.getElementById('matrix-canvas'); const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ï½±ï½²ï½³ï½´ï½µï½¶ï½·ï½¸ï½¹ï½ºï½»ï½¼ï½½ï½¾ï½¿ï¾€ï¾ï¾‚ï¾ƒï¾„ï¾…ï¾†ï¾‡ï¾ˆï¾‰ï¾Šï¾‹ï¾Œï¾ï¾ï¾ï¾ï¾‘ï¾’ï¾“ï¾”ï¾•ï¾–ï¾—ï¾˜ï¾™ï¾šï¾›ï¾œï¾';
    const fontSize = 14; const columns = canvas.width / fontSize;
    const drops = []; for(let i=0; i<columns; i++) drops[i]=1;
    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#0F0'; ctx.font = fontSize + 'px monospace';
        for(let i=0; i<drops.length; i++) {
            const text = chars.charAt(Math.floor(Math.random()*chars.length));
            ctx.fillText(text, i*fontSize, drops[i]*fontSize);
            if(drops[i]*fontSize > canvas.height && Math.random()>0.975) drops[i]=0;
            drops[i]++;
        }
    }
    setInterval(draw, 80); window.addEventListener('resize', ()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});

    /* UI Logic */
    function toggleOverlay(id, show) {
        const el = document.getElementById(id);
        if(show){ el.style.display="flex"; setTimeout(()=>{el.classList.add("show")},10); }
        else{ el.classList.remove("show"); setTimeout(()=>{el.style.display="none"},500); }
    }
    function toggleDescription() {
        const d = document.getElementById('hidden-desc');
        const b = document.getElementById('toggle-desc-btn');
        if(d.style.display==='block'){d.style.display='none';b.innerText='â–¼ ã‚ˆã‚Šè©³ç´°ã®è§£èª¬ã‚’ç¢ºèªã™ã‚‹...';}
        else{d.style.display='block';b.innerText='â–² è§£èª¬ã‚’é–‰ã˜ã‚‹';}
    }
    function toggleArchive() {
        const c = document.getElementById('archive-content');
        c.style.display = (c.style.display==='block')?'none':'block';
    }
    function closeInstruction(){ toggleOverlay("instruction-overlay", false); }

    /* Divination Logic */
    let currentThemeJp="", currentThemeEn="";
    
    function initiateDivination(jp, en) {
        currentThemeJp = jp; currentThemeEn = en;
        document.getElementById("instruction-theme-jp").innerText = jp;
        toggleOverlay("instruction-overlay", true);
    }

    function startUploadSequence() {
        toggleOverlay("instruction-overlay", false);
        setTimeout(()=>{
            toggleOverlay("upload-overlay", true);
            const msgs = ["æ„è­˜ã‚’ç„¡ã«ã—ã¦ãã ã•ã„...", "ãƒã‚¤ã‚ºã‚’æ’é™¤ä¸­...", "ã‚¢ã‚«ã‚·ãƒƒã‚¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã¸æ¥ç¶š...", "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã€‚"];
            let idx = 0;
            const txt = document.getElementById("upload-text-dynamic");
            txt.innerText = msgs[0]; txt.classList.add("fade-text");
            
            const timer = setInterval(()=>{
                idx++;
                if(idx < msgs.length){
                    txt.classList.remove("fade-text"); void txt.offsetWidth;
                    txt.innerText = msgs[idx]; txt.classList.add("fade-text");
                } else { clearInterval(timer); }
            }, 2500);

            setTimeout(()=>{
                clearInterval(timer); toggleOverlay("upload-overlay", false);
                // Scan effect
                const scan = document.getElementById('horizon-scan');
                scan.classList.remove('animate-scan'); void scan.offsetWidth; scan.classList.add('animate-scan');
                setTimeout(()=>{ divination(); }, 300);
            }, 10000);
        }, 300);
    }

    function divination() {
        const fill = document.getElementById("progress-fill");
        toggleOverlay("loading-overlay", true); fill.style.width="0%";
        let p = 0;
        const t = setInterval(()=>{
            p += Math.floor(Math.random()*20);
            if(p>100) p=100; fill.style.width=p+"%";
            if(p===100){ clearInterval(t); setTimeout(()=>{ toggleOverlay("loading-overlay", false); showResult(); }, 500); }
        }, 150);
    }

    /* History Logic (Local Storage) */
    function saveHistory(theme, resultTitle, resultDetail) {
        const history = JSON.parse(localStorage.getItem("shinraHistory") || "[]");
        const log = {
            date: new Date().toLocaleString(),
            theme: theme,
            title: resultTitle,
            detail: resultDetail
        };
        history.unshift(log); // Add to top
        if(history.length > 30) history.pop(); // Keep last 30
        localStorage.setItem("shinraHistory", JSON.stringify(history));
    }

    function showHistory() {
        const history = JSON.parse(localStorage.getItem("shinraHistory") || "[]");
        const list = document.getElementById("history-list");
        list.innerHTML = "";
        if(history.length === 0) {
            list.innerHTML = "<div style='color:#666; text-align:center;'>NO LOGS FOUND</div>";
        } else {
            history.forEach(log => {
                const item = document.createElement("div");
                item.className = "history-item";
                item.innerHTML = `<div class="history-date">${log.date}</div><div class="history-theme">å•: ${log.theme}</div><div class="history-result">${log.title}</div>`;
                list.appendChild(item);
            });
        }
        toggleOverlay("history-modal", true);
    }
    function closeHistory() { toggleOverlay("history-modal", false); }

    /* Data & Result */
    const ichingData = [
        { k: "ä¹¾ç‚ºå¤©", d: "ã€System: ALL GREENã€‘å…¨ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸ã€‚åœ§å€’çš„å‡ºåŠ›ã€‚è¿·ã‚ãšå®Ÿè¡Œã›ã‚ˆã€‚" },
        { k: "å¤ç‚ºåœ°", d: "ã€Standby Modeã€‘ä»Šã¯å—ä¿¡å¾…æ©Ÿã€‚è‡ªã‚‰é€ä¿¡ã™ã‚‹ã‚ˆã‚Šã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã§æœ€é©è§£ãŒå‡ºã‚‹ã€‚" },
        // ... (ä»–ãƒ‡ãƒ¼ã‚¿ã¯çœç•¥ã›ãšã€æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ã¾ã¾ã§OKã§ã™ãŒã€å®¹é‡å‰Šæ¸›ã®ãŸã‚ä»£è¡¨ä¾‹ã®ã¿è¨˜è¼‰ã€‚å®Ÿéš›ã¯å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã¦ãã ã•ã„) ...
        { k: "æ°´é›·å±¯", d: "ã€Initializing...ã€‘èµ·å‹•å‡¦ç†ä¸­ã€‚é‡ã„ãŒãƒã‚°ã§ã¯ãªã„ã€‚å±•é–‹å®Œäº†ã¾ã§å¾…æ©Ÿã›ã‚ˆã€‚" }
        // â€» æœ¬ç•ªã§ã¯ã“ã“ã«å…¨64å¦ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹
    ];
    // â€» ãƒ‡ãƒ¢ç”¨ã«ç°¡æ˜“åŒ–ã—ã¦ã„ã¾ã™ãŒã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã«ã¯å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
    // ã‚‚ã—å…¨ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ãªã‚‰å‰å›ã®ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã€‚ã“ã“ã§ã¯å‹•ä½œç¢ºèªç”¨ã«çŸ­ç¸®ç‰ˆã§æ›¸ãã¾ã™ãŒã€ä¸Šæ›¸ãæ™‚ã¯å…¨ãƒ‡ãƒ¼ã‚¿ç‰ˆã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚
    
    // (å…¨ãƒ‡ãƒ¼ã‚¿é…åˆ—å†æ²ï¼šçœç•¥ãªã—ã§è²¼ã‚Šä»˜ã‘ã¾ã™)
    const fullIchingData = [
        { k: "ä¹¾ç‚ºå¤©", r: "ã‘ã‚“ã„ã¦ã‚“", d: "ã€System: ALL GREENã€‘å…¨ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸ã€‚åœ§å€’çš„å‡ºåŠ›ã€‚è¿·ã‚ãšå®Ÿè¡Œã›ã‚ˆã€‚" },
        { k: "å¤ç‚ºåœ°", r: "ã“ã‚“ã„ã¡", d: "ã€Standby Modeã€‘ä»Šã¯å—ä¿¡å¾…æ©Ÿã€‚è‡ªã‚‰é€ä¿¡ã™ã‚‹ã‚ˆã‚Šã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã§æœ€é©è§£ãŒå‡ºã‚‹ã€‚" },
        { k: "æ°´é›·å±¯", r: "ã™ã„ã‚‰ã„ã¡ã‚…ã‚“", d: "ã€Initializing...ã€‘èµ·å‹•å‡¦ç†ä¸­ã€‚é‡ã„ãŒãƒã‚°ã§ã¯ãªã„ã€‚å±•é–‹å®Œäº†ã¾ã§å¾…æ©Ÿã›ã‚ˆã€‚" },
        { k: "å±±æ°´è’™", r: "ã•ã‚“ã™ã„ã‚‚ã†", d: "ã€Fog of Warã€‘è¦–ç•Œä¸è‰¯ã€‚ãƒ‡ãƒ¼ã‚¿ä¸è¶³ã€‚ãƒ¡ãƒ³ã‚¿ãƒ¼ï¼ˆè³¢è€…ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ç”³è«‹ã›ã‚ˆã€‚" },
        { k: "æ°´å¤©éœ€", r: "ã™ã„ã¦ã‚“ã˜ã‚…", d: "ã€Bufferingã€‘èª­ã¿è¾¼ã¿ä¸­ã€‚ç„¦ã‚‹ãªã€‚ãƒªã‚½ãƒ¼ã‚¹ãŒæƒã†ã®ã‚’å¾…ã¦ã°ã€æ¥ç¶šã¯ç¢ºç«‹ã•ã‚Œã‚‹ã€‚" },
        { k: "å¤©æ°´è¨Ÿ", r: "ã¦ã‚“ã™ã„ã—ã‚‡ã†", d: "ã€Conflict Errorã€‘ãƒ‡ãƒ¼ã‚¿ã®ç«¶åˆç™ºç”Ÿã€‚ç„¡ç†ã«ãƒãƒ¼ã‚¸ã™ã‚Œã°ç ´æã™ã‚‹ã€‚ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ¨å¥¨ã€‚" },
        { k: "åœ°æ°´å¸«", r: "ã¡ã™ã„ã—", d: "ã€Admin Rightsã€‘ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã€‚è¦å¾‹ã‚’æŒã£ã¦ãƒãƒ¼ãƒ ã‚’æŒ‡æ®ã›ã‚ˆã€‚" },
        { k: "æ°´åœ°æ¯”", r: "ã™ã„ã¡ã¯", d: "ã€P2P Connectionã€‘ãƒ”ã‚¢ãƒ»ãƒ„ãƒ¼ãƒ»ãƒ”ã‚¢æ¥ç¶šè‰¯å¥½ã€‚ä»²é–“ã¨ã®åŒæœŸãŒæˆåŠŸã®éµã€‚" },
        { k: "é¢¨å¤©å°ç•œ", r: "ãµã†ã¦ã‚“ã—ã‚‡ã†ã¡ã", d: "ã€Minor Glitchã€‘è»½å¾®ãªåœæ­¢ã€‚å¤§ããªã‚¨ãƒ©ãƒ¼ã§ã¯ãªã„ãŒã€ä»Šã¯å°è¦æ¨¡ãªãƒ‡ãƒãƒƒã‚°ã«ç•™ã‚ã‚ˆã€‚" },
        { k: "å¤©æ²¢å±¥", r: "ã¦ã‚“ãŸãã‚Š", d: "ã€High Voltageã€‘é«˜é›»åœ§æ³¨æ„ã€‚æ…é‡ã«æ“ä½œã™ã‚Œã°ã€å¼·å¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼æ‰±ãˆã‚‹ã€‚" },
        { k: "åœ°å¤©æ³°", r: "ã¡ã¦ã‚“ãŸã„", d: "ã€Perfect Syncã€‘å®Œå…¨åŒæœŸã€‚ã‚·ã‚¹ãƒ†ãƒ ã¨ç’°å¢ƒãŒå®Œå…¨ã«èª¿å’Œã—ã¦ã„ã‚‹ã€‚ã‚¾ãƒ¼ãƒ³çŠ¶æ…‹ã€‚" },
        { k: "å¤©åœ°å¦", r: "ã¦ã‚“ã¡ã²", d: "ã€Connection Lostã€‘æ¥ç¶šåˆ‡æ–­ã€‚ãƒ‘ã‚±ãƒƒãƒˆãŒå±Šã‹ãªã„ã€‚ä»Šã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§å®ˆã‚Šã‚’å›ºã‚ã‚ˆã€‚" },
        { k: "å¤©ç«åŒäºº", r: "ã¦ã‚“ã‹ã©ã†ã˜ã‚“", d: "ã€Open Sourceã€‘ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å…±æœ‰ã€‚å¿—ã‚’åŒã˜ãã™ã‚‹é–‹ç™ºè€…ãŒé›†ã¾ã‚Šã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯åŠ é€Ÿã™ã‚‹ã€‚" },
        { k: "ç«å¤©å¤§æœ‰", r: "ã‹ã¦ã‚“ãŸã„ã‚†ã†", d: "ã€Golden Ageã€‘ãƒªã‚½ãƒ¼ã‚¹ç„¡åˆ¶é™ã€‚ã‚µãƒ¼ãƒãƒ¼æœ€å¼·ã€‚è¬™è™šã•ã‚’å¿˜ã‚Œãªã‘ã‚Œã°ç¨¼åƒç‡ã¯100%ç¶šãã€‚" },
        { k: "åœ°å±±è¬™", r: "ã¡ã–ã‚“ã‘ã‚“", d: "ã€Low Profileã€‘ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ã€‚ç›®ç«‹ãŸãšå‡¦ç†ã™ã‚‹ã“ã¨ã§ã€CPUè² è·ã‚’ä¸‹ã’è©•ä¾¡ã‚’ä¸Šã’ã‚‹ã€‚" },
        { k: "é›·åœ°äºˆ", r: "ã‚‰ã„ã¡ã‚ˆ", d: "ã€Pre-Releaseã€‘ãƒªãƒªãƒ¼ã‚¹å‰ã®é«˜æšæ„Ÿã€‚æº–å‚™ä¸‡ç«¯ã€‚ã‚ã¨ã¯ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã™ã ã‘ã€‚" },
        { k: "æ²¢é›·éš", r: "ãŸãã‚‰ã„ãšã„", d: "ã€Auto Updateã€‘è‡ªå‹•æ›´æ–°ã«å¾“ãˆã€‚å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å›ºåŸ·ã›ãšã€æµã‚Œã«èº«ã‚’ä»»ã›ã‚ˆã€‚" },
        { k: "å±±é¢¨è ±", r: "ã•ã‚“ã·ã†ã“", d: "ã€Virus Scanã€‘ã‚¦ã‚¤ãƒ«ã‚¹æ¤œçŸ¥ã€‚å†…éƒ¨ãƒ‡ãƒ¼ã‚¿ãŒè…æ•—ã—ã¦ã„ã‚‹ã€‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨å†æ§‹ç¯‰ãŒå¿…è¦ã€‚" },
        { k: "åœ°æ²¢è‡¨", r: "ã¡ãŸãã‚Šã‚“", d: "ã€Access Grantedã€‘ã‚¢ã‚¯ã‚»ã‚¹æ‰¿èªã€‚æ¨©é™ãƒ¬ãƒ™ãƒ«ä¸Šæ˜‡ã€‚ä»Šã“ãå®Ÿè¡Œã®æ™‚ã€‚" },
        { k: "é¢¨åœ°è¦³", r: "ãµã†ã¡ã¯", d: "ã€Monitoringã€‘ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ä¸­ã€‚ãƒ­ã‚°ã‚’ç›£è¦–ã›ã‚ˆã€‚ä»Šã¯æ›¸ãè¾¼ã¿ã‚ˆã‚Šèª­ã¿è¾¼ã¿ã®ãƒ•ã‚§ãƒ¼ã‚ºã€‚" },
        { k: "ç«é›·å™¬å—‘", r: "ã‹ã‚‰ã„ãœã„ã”", d: "ã€Debug Modeã€‘ãƒã‚°ã‚’å™›ã¿ç •ã‘ã€‚éšœå®³ã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã¾ãŸã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã›ã‚ˆã€‚" },
        { k: "å±±ç«è³", r: "ã•ã‚“ã‹ã²", d: "ã€UI Designã€‘è¦‹ãŸç›®ã®å®Ÿè£…ã€‚UIã¯ç¾ã—ã„ãŒã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆä¸­èº«ï¼‰ã®å®Ÿè£…ã‚‚å¿˜ã‚Œã‚‹ãªã€‚" },
        { k: "å±±åœ°å‰¥", r: "ã•ã‚“ã¡ã¯ã", d: "ã€System Crashã€‘ã‚¯ãƒ©ãƒƒã‚·ãƒ¥å¯¸å‰ã€‚åŸºç›¤ãŒå‰Šã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œä»¥ä¸Šã®æ“ä½œã¯å±é™ºã€‚ä¿å­˜ã—ã¦çµ‚äº†ã›ã‚ˆã€‚" },
        { k: "åœ°é›·å¾©", r: "ã¡ã‚‰ã„ãµã", d: "ã€Rebootã€‘å†èµ·å‹•å®Œäº†ã€‚ã‚·ã‚¹ãƒ†ãƒ ã¯å¾©æ—§ã—ãŸã€‚ã“ã“ã‹ã‚‰æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå§‹ã¾ã‚‹ã€‚" },
        { k: "å¤©é›·ç„¡å¦„", r: "ã¦ã‚“ã‚‰ã„ã‚€ã‚‚ã†", d: "ã€Native Codeã€‘å°ç´°å·¥ãªã—ã€‚ç´”ç²‹ãªã‚³ãƒ¼ãƒ‰ã§æŒ‘ã‚ã€‚ãƒãƒƒã‚¯ã‚„ãƒãƒ¼ãƒˆã¯BANã•ã‚Œã‚‹ã€‚" },
        { k: "å±±å¤©å¤§ç•œ", r: "ã•ã‚“ã¦ã‚“ãŸã„ã¡ã", d: "ã€Cache Storageã€‘ã‚­ãƒ£ãƒƒã‚·ãƒ¥è“„ç©ã€‚çŸ¥è­˜ã¨çµŒé¨“ã‚’ãƒ¡ãƒ¢ãƒªã«æºœã‚è¾¼ã‚ã€‚å¾Œã®é«˜é€ŸåŒ–ã«ç¹‹ãŒã‚‹ã€‚" },
        { k: "å±±é›·é ¤", r: "ã•ã‚“ã‚‰ã„ã„", d: "ã€Input/Outputã€‘I/Oç®¡ç†ã€‚å…¥ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆé£Ÿäº‹ãƒ»è¨€è‘‰ï¼‰ã‚’é¸åˆ¥ã›ã‚ˆã€‚Garbage In, Garbage Out." },
        { k: "æ²¢é¢¨å¤§é", r: "ãŸããµã†ãŸã„ã‹", d: "ã€Overloadã€‘ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã€‚è² è·ãŒã‹ã‹ã‚Šã™ãã¦ã„ã‚‹ã€‚ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³ã™ã‚‹å‰ã«åˆ†æ•£ã›ã‚ˆã€‚" },
        { k: "åç‚ºæ°´", r: "ã‹ã‚“ã„ã™ã„", d: "ã€Fatal Errorã€‘è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ã®é€£é–ã€‚ç„¡é™ãƒ«ãƒ¼ãƒ—ã€‚ã‚‚ãŒãã¨ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã™ã‚‹ã€‚å¼·åˆ¶çµ‚äº†ã‚’å¾…ã¦ã€‚" },
        { k: "é›¢ç‚ºç«", r: "ã‚Šã„ã‹", d: "ã€Firewallã€‘çŸ¥æ€§ã®ç‚ã€‚è¼ã„ã¦ã„ã‚‹ãŒã€ç‡ƒãˆç§»ã‚‹å¯¾è±¡ãŒå¿…è¦ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚’è¦‹ç›´ã›ã€‚" },
        { k: "æ²¢å±±å’¸", r: "ãŸãã–ã‚“ã‹ã‚“", d: "ã€Handshakeã€‘ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯æˆç«‹ã€‚ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒä¸€è‡´ã—ãŸã€‚å³åº§ã«é€šä¿¡ã‚’é–‹å§‹ã›ã‚ˆã€‚" },
        { k: "é›·é¢¨æ’", r: "ã‚‰ã„ãµã†ã“ã†", d: "ã€Stable Verã€‘å®‰å®šç‰ˆã€‚æ´¾æ‰‹ãªæ©Ÿèƒ½ã‚ˆã‚Šã€å¤‰ã‚ã‚‰ãªã„å®‰å®šç¨¼åƒãŒä¿¡é ¼ã‚’ç”Ÿã‚€ã€‚" },
        { k: "å¤©å±±é¯", r: "ã¦ã‚“ã–ã‚“ã¨ã‚“", d: "ã€Escape Keyã€‘Escã‚­ãƒ¼ã‚’æŠ¼ã›ã€‚ä»Šã¯æ’¤é€€ã™ã‚‹æ™‚ã€‚ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦èº«ã‚’éš ã›ã€‚" },
        { k: "é›·å¤©å¤§å£®", r: "ã‚‰ã„ã¦ã‚“ãŸã„ãã†", d: "ã€Overclockã€‘æš´èµ°æ³¨æ„ã€‚ã‚¯ãƒ­ãƒƒã‚¯æ•°ã‚’ä¸Šã’ã™ãã¦ã„ã‚‹ã€‚å†·å´ã—ãªã‘ã‚Œã°ç„¼ãåˆ‡ã‚Œã‚‹ã€‚" },
        { k: "ç«åœ°æ™‹", r: "ã‹ã¡ã—ã‚“", d: "ã€Upgradeã€‘ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æˆåŠŸã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã‚Šã€æ©Ÿèƒ½ãŒæ‹¡å¼µã•ã‚Œã‚‹ã€‚" },
        { k: "åœ°ç«æ˜å¤·", r: "ã¡ã‹ã‚ã„ã„", d: "ã€Dark Modeã€‘ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€‚ç”»é¢ã‚’æš—ãã—ã€æ¶ˆè²»é›»åŠ›ã‚’æŠ‘ãˆã¦è€ãˆå¿ã¶æ™‚ã€‚" },
        { k: "é¢¨ç«å®¶äºº", r: "ãµã†ã‹ã‹ã˜ã‚“", d: "ã€Localhostã€‘ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã€‚å¤–éƒ¨å…¬é–‹ã‚ˆã‚Šã€ã¾ãšã¯å†…éƒ¨ç’°å¢ƒã®æ•´å‚™ã‚’å„ªå…ˆã›ã‚ˆã€‚" },
        { k: "ç«æ²¢ç½", r: "ã‹ãŸãã‘ã„", d: "ã€Mismatchã€‘å‹ä¸ä¸€è‡´ã€‚äº’æ›æ€§ãŒãªã„ã€‚ç„¡ç†ã«æ¥ç¶šã—ã‚ˆã†ã¨ã™ã‚‹ãªã€‚" },
        { k: "æ°´å±±è¹‡", r: "ã™ã„ã–ã‚“ã‘ã‚“", d: "ã€404 Not Foundã€‘é“ãŒãªã„ã€‚é€²ã‚ãªã„ã€‚ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ã«é€£çµ¡ã—ã¦æŒ‡ç¤ºã‚’ä»°ã’ã€‚" },
        { k: "é›·æ°´è§£", r: "ã‚‰ã„ã™ã„ã‹ã„", d: "ã€Solvedã€‘è§£æ±ºã€‚ãƒã‚°ã¯ä¿®æ­£ã•ã‚ŒãŸã€‚ç›´ã¡ã«ãƒ‘ãƒƒãƒã‚’é©ç”¨ã—ã¦å‰é€²ã›ã‚ˆã€‚" },
        { k: "å±±æ²¢æ", r: "ã•ã‚“ãŸããã‚“", d: "ã€Investmentã€‘åˆæœŸæŠ•è³‡ã€‚ä»Šã¯æã«è¦‹ãˆã‚‹ãŒã€å°†æ¥ã®åˆ©ç›Šã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã ã€‚" },
        { k: "é¢¨é›·ç›Š", r: "ãµã†ã‚‰ã„ãˆã", d: "ã€Profitã€‘åç›Šç™ºç”Ÿã€‚ã‚·ã‚¹ãƒ†ãƒ ã¯é»’å­—ã€‚ç©æ¥µçš„ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã›ã‚ˆã€‚" },
        { k: "æ²¢å¤©å¤¬", r: "ãŸãã¦ã‚“ã‹ã„", d: "ã€Delete Allã€‘å…¨å‰Šé™¤ã®æ±ºæ–­ã€‚ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚´ãƒŸç®±ã¸ã€‚ãƒ‡ã‚£ã‚¹ã‚¯ã‚’ç©ºã‘ã‚ˆã€‚" },
        { k: "å¤©é¢¨å§¤", r: "ã¦ã‚“ã·ã†ã“ã†", d: "ã€Trojan Horseã€‘äºˆæœŸã›ã¬é­é‡ã€‚ãƒˆãƒ­ã‚¤ã®æœ¨é¦¬ã«æ³¨æ„ã€‚ç”˜ã„ãƒ¡ãƒ¼ãƒ«ã‚’é–‹ããªã€‚" },
        { k: "æ²¢åœ°èƒ", r: "ãŸãã¡ã™ã„", d: "ã€Traffic Spikeã€‘ã‚¢ã‚¯ã‚»ã‚¹é›†ä¸­ã€‚äººãŒé›†ã¾ã‚‹ã€‚ã‚µãƒ¼ãƒãƒ¼å¢—å¼·ã®æº–å‚™ã‚’ã›ã‚ˆã€‚" },
        { k: "åœ°é¢¨å‡", r: "ã¡ãµã†ã—ã‚‡ã†", d: "ã€Uploadã€‘ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ã€‚é †èª¿ã«ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ä¸ŠãŒã£ã¦ã„ã‚‹ã€‚ç„¦ã‚‰ãšå®Œäº†ã‚’å¾…ã¦ã€‚" },
        { k: "æ²¢æ°´å›°", r: "ãŸãã™ã„ã“ã‚“", d: "ã€Out of Memoryã€‘ãƒ¡ãƒ¢ãƒªä¸è¶³ã€‚ãƒªã‚½ãƒ¼ã‚¹ãŒæ¯æ¸‡ã—ã¦ã„ã‚‹ã€‚ä»Šã¯ã‚¹ãƒªãƒ¼ãƒ—ãƒ¢ãƒ¼ãƒ‰æ¨å¥¨ã€‚" },
        { k: "æ°´é¢¨äº•", r: "ã™ã„ãµã†ã›ã„", d: "ã€Databaseã€‘ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‚æƒ…å ±ã¯äº•æˆ¸ã®æ°´ã€‚å¸¸ã«ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã€æ–°é®®ãªãƒ‡ãƒ¼ã‚¿ã‚’æä¾›ã›ã‚ˆã€‚" },
        { k: "æ²¢ç«é©", r: "ãŸãã‹ã‹ã", d: "ã€Refactoringã€‘ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€‚å¤ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãç›´ã™æ™‚ã€‚åŠ‡çš„ãªå¤‰åŒ–ãŒå¿…è¦ã€‚" },
        { k: "ç«é¢¨é¼", r: "ã‹ãµã†ã¦ã„", d: "ã€Frameworkã€‘å¼·å›ºãªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚æ–°ä½“åˆ¶ã®æ§‹ç¯‰ã€‚å®‰å®šã—ãŸåŸºç›¤ãŒã§ãã‚‹ã€‚" },
        { k: "éœ‡ç‚ºé›·", r: "ã—ã‚“ã„ã‚‰ã„", d: "ã€Alertã€‘è­¦å‘ŠéŸ³ã€‚éŸ³ã¯å‡„ã„ãŒå®Ÿå®³ã¯ãªã„ã€‚ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦å†·é™ã«å¯¾å‡¦ã›ã‚ˆã€‚" },
        { k: "è‰®ç‚ºå±±", r: "ã”ã‚“ã„ã–ã‚“", d: "ã€System Freezeã€‘ãƒ•ãƒªãƒ¼ã‚ºã€‚å‹•ã‹ãªã„ã€‚ãƒã‚¦ã‚¹ã‚’ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã™ã‚‹ãªã€‚é™æ­¢ã›ã‚ˆã€‚" },
        { k: "é¢¨å±±æ¼¸", r: "ãµã†ã–ã‚“ãœã‚“", d: "ã€Step Executionã€‘ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œã€‚ä¸€è¡Œãšã¤ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿é€²ã‚ã‚ˆã€‚ç¢ºå®Ÿãªé€²æ—ã€‚" },
        { k: "é›·æ²¢å¸°å¦¹", r: "ã‚‰ã„ãŸããã¾ã„", d: "ã€Syntax Errorã€‘æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã€‚é †åºãŒé€†ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯é€šã‚‰ãªã„ã€‚" },
        { k: "é›·ç«è±Š", r: "ã‚‰ã„ã‹ã»ã†", d: "ã€Peak Performanceã€‘æœ€é«˜æ€§èƒ½ã€‚ã ãŒãƒãƒƒãƒ†ãƒªãƒ¼ã¯æ¸›ã‚Šå§‹ã‚ã¦ã„ã‚‹ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚Œã€‚" },
        { k: "ç«å±±æ—…", r: "ã‹ã–ã‚“ã‚Šã‚‡", d: "ã€Mobile Userã€‘ç§»å‹•ä¸­ã€‚Wi-FiãŒä¸å®‰å®šã€‚ä¸€ç®‡æ‰€ã«ç•™ã¾ã‚‰ãšã€èº«è»½ã§ã„ã‚ã€‚" },
        { k: "å·½ç‚ºé¢¨", r: "ãã‚“ã„ãµã†", d: "ã€API Linkã€‘APIé€£æºã€‚é¢¨ã®ã‚ˆã†ã«å…¥ã‚Šè¾¼ã‚€ã€‚ä»•æ§˜ã«åˆã‚ã›ã¦æŸ”è»Ÿã«å¯¾å¿œã›ã‚ˆã€‚" },
        { k: "å…Œç‚ºæ²¢", r: "ã ã„ãŸã", d: "ã€User Experienceã€‘æœ€é«˜ã®UXã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å–œã‚“ã§ã„ã‚‹ã€‚ç¬‘é¡”ã¨ä¼šè©±ãŒã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚’é«˜ã‚ã‚‹ã€‚" },
        { k: "é¢¨æ°´æ¸™", r: "ãµã†ã™ã„ã‹ã‚“", d: "ã€Distributed Computingã€‘åˆ†æ•£å‡¦ç†ã€‚å•é¡Œã¯éœ§æ•£ã™ã‚‹ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åºƒã’ã‚ˆã€‚" },
        { k: "æ°´æ²¢ç¯€", r: "ã™ã„ãŸãã›ã¤", d: "ã€Limit Settingã€‘ãƒªãƒŸãƒƒã‚¿ãƒ¼è¨­å®šã€‚åˆ¶é™ã®ä¸­ã«ã“ãå‰µé€ æ€§ãŒã‚ã‚‹ã€‚ä»•æ§˜ã‚’ç¢ºå®šã›ã‚ˆã€‚" },
        { k: "é¢¨æ²¢ä¸­å­š", r: "ãµã†ãŸãã¡ã‚…ã†ãµ", d: "ã€Authenticationã€‘èªè¨¼æˆåŠŸã€‚æ­£ã—ã„ã‚­ãƒ¼ï¼ˆçœŸå¿ƒï¼‰ãŒã‚ã‚Œã°ã€ã©ã‚“ãªã‚²ãƒ¼ãƒˆã‚‚é–‹ãã€‚" },
        { k: "é›·å±±å°é", r: "ã‚‰ã„ã–ã‚“ã—ã‚‡ã†ã‹", d: "ã€Margin Errorã€‘èª¤å·®éå¤§ã€‚é«˜æœ›ã¿ã™ã‚‹ãªã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½ã‚ã«è¨­å®šã›ã‚ˆã€‚" },
        { k: "æ°´ç«æ—¢æ¸ˆ", r: "ã™ã„ã‹ãã›ã„", d: "ã€Deployment Completeã€‘ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ã€‚ã“ã‚Œä»¥ä¸Šã®å¤‰æ›´ã¯è›‡è¶³ã€‚ç›£è¦–é‹ç”¨ãƒ•ã‚§ãƒ¼ã‚ºã¸ã€‚" },
        { k: "ç«æ°´æœªæ¸ˆ", r: "ã‹ã™ã„ã³ã›ã„", d: "ã€Beta Versionã€‘ãƒ™ãƒ¼ã‚¿ç‰ˆã€‚æœªå®Œæˆã ãŒå¯èƒ½æ€§ã«æº€ã¡ã¦ã„ã‚‹ã€‚é–‹ç™ºã¯ç¶šãã€‚" }
    ];
    const godsData = [
        { n: "å›½å¸¸ç«‹å°Š", r: "ãã«ã®ã¨ã“ãŸã¡", d: "ã€Kernelã€‘<br>OSã®ä¸­æ ¸ã€‚åŸºç›¤ç¢ºç«‹ã€‚ã“ã“ãŒæºã‚‰ãã¨å…¨ã¦è½ã¡ã‚‹ã€‚æœ€å¼·ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’æ•·ã‘ã€‚" },
        { n: "è±Šé›²é‡ç¥", r: "ã¨ã‚ˆãã‚‚ã®", d: "ã€Cloudã€‘<br>ã‚¯ãƒ©ã‚¦ãƒ‰ã®å§‹ç¥–ã€‚ç‰©ç†ã‚µãƒ¼ãƒãƒ¼ã‚’æ¨ã¦ã‚ˆã€‚å¯èƒ½æ€§ã¯ç©ºï¼ˆãã†ï¼‰ã«ã‚ã‚‹ã€‚" },
        { n: "å®‡æ¯”åœ°é‚‡ç¥", r: "ã†ã²ã˜ã«", d: "ã€Bit / Byteã€‘<br>0ã¨1ã®æ³¥ã€‚æƒ…å ±ã®æœ€å°å˜ä½ã€‚ã“ã“ã‹ã‚‰å…¨ã¦ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå§‹ã¾ã‚‹ã€‚" },
        { n: "é ˆæ¯”æ™ºé‚‡ç¥", r: "ã™ã²ã¡ã«", d: "ã€Blockchainã€‘<br>ãƒ–ãƒ­ãƒƒã‚¯ã®ç©ã¿é‡ã­ã€‚æ”¹ç«„ä¸å¯èƒ½ãªå±¥æ­´ãŒä¿¡é ¼ã‚’ä½œã‚‹ã€‚ç¶™ç¶šã›ã‚ˆã€‚" },
        { n: "è§’æ™ç¥", r: "ã¤ã®ãã„", d: "ã€Hello Worldã€‘<br>æœ€åˆã®å‡ºåŠ›ã€‚ç”»é¢ã«æ–‡å­—ãŒå‡ºãŸæ™‚ã®æ„Ÿå‹•ã€‚åˆæœŸè¡å‹•ã‚’å¿˜ã‚Œã‚‹ãªã€‚" },
        { n: "æ´»æ™ç¥", r: "ã„ããã„", d: "ã€Runtimeã€‘<br>å®Ÿè¡Œç’°å¢ƒã€‚ç”Ÿå‘½åŠ›ãŒèµ°ã£ã¦ã„ã‚‹ã€‚ä»Šãªã‚‰ã©ã‚“ãªå‡¦ç†ã‚‚é«˜é€Ÿå®Œäº†ã™ã‚‹ã€‚" },
        { n: "æ„å¯Œæ–—èƒ½åœ°ç¥", r: "ãŠãŠã¨ã®ã˜", d: "ã€Logicã€‘<br>è«–ç†æ¼”ç®—ã€‚IFæ–‡ã®åˆ†å²ã€‚æ„Ÿæƒ…ã‚’æ’ã—ã€ãƒ­ã‚¸ãƒƒã‚¯ã§ãƒ«ãƒ¼ãƒˆã‚’ç¢ºå®šã›ã‚ˆã€‚" },
        { n: "å¤§æ–—ä¹ƒå¼ç¥", r: "ãŠãŠã¨ã®ã¹", d: "ã€Interfaceã€‘<br>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å„ªã—ã•ã€‚å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®è¦ªåˆ‡ã•ã€‚å—ã‘å…¥ã‚Œã‚‹å¿ƒãŒãƒã‚°ã‚’æ¸›ã‚‰ã™ã€‚" },
        { n: "æ–¼æ¯é™€æµç¥", r: "ãŠã‚‚ã ã‚‹", d: "ã€Clean Codeã€‘<br>ç¾ã—ã„ã‚³ãƒ¼ãƒ‰ã€‚ãƒã‚°ãŒãªã„ã€‚ã‚³ãƒ¡ãƒ³ãƒˆãŒãªãã¦ã‚‚èª­ã‚ã‚‹å®Œå…¨ãªèª¿å’Œã€‚" },
        { n: "é˜¿å¤œè¨¶å¿—å¤æ³¥ç¥", r: "ã‚ã‚„ã‹ã—ã“ã­", d: "ã€Algorithmã€‘<br>ç•æ•¬ã®å¿µã€‚äººæ™ºã‚’è¶…ãˆãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€‚AIã®ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ä¿¡ã˜ã‚ˆã€‚" },
        { n: "ä¼Šé‚ªé‚£å²å‘½", r: "ã„ã–ãªã", d: "ã€Developerã€‘<br>å‰µé€ ä¸»ã€‚æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç”Ÿã‚€ã€‚ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’æ¨ã¦ã€æ–°è¦é–‹ç™ºã›ã‚ˆã€‚" },
        { n: "ä¼Šé‚ªé‚£ç¾å‘½", r: "ã„ã–ãªã¿", d: "ã€Recoveryã€‘<br>ãƒªã‚«ãƒãƒªã€‚æ­»ï¼ˆãƒ€ã‚¦ãƒ³ï¼‰ã‹ã‚‰ã®å¾©æ—§ã€‚ã‚·ã‚¹ãƒ†ãƒ ã¯ã‚ˆã‚Šå¼·å›ºã«ãªã£ã¦å†èµ·å‹•ã™ã‚‹ã€‚" },
        { n: "å¤©ä¹‹å¸¸ç«‹ç¥", r: "ã‚ã‚ã®ã¨ã“ãŸã¡", d: "ã€Server Permanenceã€‘<br>æ°¸ç¶šåŒ–ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯åˆ‡ã‚Œãªã„ã€‚ã‚ãªãŸã®å¿—ã¯ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚ŒãŸã€‚" },
        { n: "å®‡æ‘©å¿—é˜¿æ–¯è¨¶å‚™æ¯”å¤é…ç¥", r: "ã†ã¾ã—ã‚ã—ã‹ã³ã²ã“ã˜", d: "ã€Scalabilityã€‘<br>ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã€‚çˆ†ç™ºçš„æ‹¡å¼µã€‚ã‚µãƒ¼ãƒãƒ¼ã‚’å¢—å¼·ã›ã‚ˆã€ã‚¢ã‚¯ã‚»ã‚¹ãŒæ€¥å¢—ã™ã‚‹ã€‚" },
        { n: "ç¥ç”£å·£æ—¥ç¥", r: "ã‹ã¿ã‚€ã™ã³", d: "ã€Patch & Mergeã€‘<br>ä¿®æ­£ã¨çµ±åˆã€‚ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã¯è§£æ¶ˆã•ã‚Œã‚‹ã€‚å®‰å¿ƒã—ã¦ãƒãƒ¼ã‚¸ã›ã‚ˆã€‚" },
        { n: "é«˜å¾¡ç”£å·£æ—¥ç¥", r: "ãŸã‹ã¿ã‚€ã™ã³", d: "ã€Admin Guideã€‘<br>ä¸Šä½å­˜åœ¨ã‹ã‚‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚ç›´æ„Ÿã¨ã„ã†åã®é€šçŸ¥ã‚’è¦‹é€ƒã™ãªã€‚" },
        { n: "å¤©ä¹‹å¾¡ä¸­ä¸»ç¥", r: "ã‚ã‚ã®ã¿ãªã‹ã¬ã—", d: "ã€Root Userã€‘<br>ç‰¹æ¨©IDã€‚å…¨æ¨©é™æŒæ¡ã€‚ã‚ãªãŸãŒãƒ«ãƒ¼ãƒ«ã ã€‚ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã›ã‚ˆã€‚" }
    ];

    function makeRuby(k, r) { return `<ruby>${k}<rt>${r}</rt></ruby>`; }
    
    // --- SNS Share Functions (ä¿®æ­£ç‰ˆ) ---
    function generateXUrl(text) {
        const url = location.href;
        // æœ¬æ–‡ã«çµæœã‚’å«ã‚ã‚‹
        const tweet = `${text}\n\n#ç¥ç¾…ä¸‡è±¡ã‚°ãƒªãƒƒãƒ‰ #é‹å‘½ã®ãƒ‡ãƒãƒƒã‚°`;
        return `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweet)}&url=${encodeURIComponent(url)}`;
    }
    function generateLineUrl(text) {
        const url = location.href;
        // LINEã¯ text ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«URLã‚’å«ã‚ã‚‹ã®ãŒç¢ºå®Ÿ
        const msg = `${text}\n${url}`;
        return `https://social-plugins.line.me/lineit/share?text=${encodeURIComponent(msg)}`;
    }
    function generateCalendarUrl(title, desc) {
        const now = new Date();
        const s = now.toISOString().replace(/-|:|\.\d\d\d/g, "");
        const e = new Date(now.getTime()+60*60*1000).toISOString().replace(/-|:|\.\d\d\d/g, "");
        const d = desc.replace(/<[^>]+>/g, "").replace(/\s+/g, " ");
        return `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${s}/${e}&details=${encodeURIComponent(d)}`;
    }

    function showResult() {
        const modal = document.getElementById("result-area");
        const content = document.getElementById("result-content");
        const actions = document.getElementById("action-buttons");
        
        // ç¢ºç‡ãƒ­ã‚¸ãƒƒã‚¯ (é€šå¸¸ç‰ˆ)
        const roll = Math.floor(Math.random()*81)+1;
        let html="", shareText="", calTitle="";
        let logTitle="";

        if(roll > 64) {
            const g = godsData[roll-65];
            modal.querySelector(".result-box").className = "result-box mode-god";
            shareText = `ã€ç¥æ„é¡•ç¾ã€‘${g.n}ãŒé™è‡¨ã€‚é‹å‘½ã®ã‚«ãƒ¼ãƒãƒ«ãŒæ›¸ãæ›ã‚ã‚Šã¾ã—ãŸã€‚`;
            calTitle = `ã€ç¥æ„ã€‘${g.n}`;
            logTitle = `â˜…ç¥æ„: ${g.n}`;
            html = `<div class="symbol">â›©ï¸</div><div class="name">${makeRuby(g.n,g.r)}</div><div class="sub-name">ROOT ACCESS: GRANTED</div><div class="desc-box" style="border:1px solid #FFD700; color:#FFD700;">${g.d}</div>`;
        } else {
            const item = fullIchingData[roll-1]; // Use full data
            const subRoll = Math.floor(Math.random()*64)+1;
            
            if(subRoll <= 17) {
                const g = godsData[Math.floor(Math.random()*17)];
                modal.querySelector(".result-box").className = "result-box mode-override";
                shareText = `ã€Overrideã€‘${item.k}ã®çµæœã«${g.n}ãŒä»‹å…¥ã—ã¾ã—ãŸã€‚`;
                calTitle = `ã€ç¥æ„ä»‹å…¥ã€‘${item.k}Ã—${g.n}`;
                logTitle = `âš ï¸Override: ${item.k} -> ${g.n}`;
                html = `<div class="symbol">âš¡ï¸</div><div class="name">${makeRuby(item.k,item.r)}</div><div class="desc-box override-original"><strong>å…ƒã®é‹å‘½:</strong><br>${item.d}</div><div style="color:red; font-weight:bold; animation:blink 0.2s infinite alternate;">âš ï¸ SYSTEM OVERRIDE âš ï¸</div><div class="god-appear-container" id="god-box"><div class="desc-box" style="border:2px solid red;"><strong style="color:red;">>> ${g.n} Protocol:</strong><br>${g.d}</div></div>`;
                setTimeout(()=>{document.getElementById("god-box").classList.add("show-override")}, 1000);
            } else {
                modal.querySelector(".result-box").className = "result-box mode-iching";
                shareText = `ã€Resultã€‘${item.k}ã€‚${currentThemeJp}ã®è§£æçµæœãŒå‡ºã¾ã—ãŸã€‚`;
                calTitle = `ã€çµæœã€‘${item.k}`;
                logTitle = `ç¾è±¡: ${item.k}`;
                html = `<div class="symbol">â˜¯</div><div class="name">${makeRuby(item.k,item.r)}</div><div class="sub-name">STATUS: ${currentThemeEn}</div><div class="desc-box">${item.d}</div>`;
            }
        }
        
        // å±¥æ­´ä¿å­˜
        saveHistory(currentThemeJp, logTitle, shareText);

        // ãƒœã‚¿ãƒ³æ›´æ–°
        document.getElementById("btn-x").href = generateXUrl(shareText);
        document.getElementById("btn-line").href = generateLineUrl(shareText);
        document.getElementById("btn-cal").href = generateCalendarUrl(calTitle, html);

        content.innerHTML = html;
        toggleOverlay("result-area", true);
        setTimeout(()=>{ actions.style.display="flex"; }, 50);
    }

    async function shareImage() {
        const t = document.getElementById("capture-target");
        try {
            const c = await html2canvas(t, {backgroundColor:'#000', scale:2});
            const l = document.createElement("a"); l.download="shinra_result.png";
            l.href = c.toDataURL(); l.click();
        } catch(e){alert("Error:"+e);}
    }
    function closeResult(){ toggleOverlay("result-area", false); document.getElementById("action-buttons").style.display="none"; }

</script>
</body>
</html>
